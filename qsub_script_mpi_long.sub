#!/bin/bash
#PBS -S /bin/bash
#
#PBS -l nodes=1:ppn=16,walltime=100:00:00 -q gigatlong

#PBS -N myjob

#PBS -o out-hostname-XyZ-N1x1-qsub.txt
#PBS -j oe
#PBS -e out-hostname-XyZ-N1x1.txt


#------------------SETTING THE ENVIRONMENT----------------------------#
#
export mkPrefix=/u/sw
source $mkPrefix/etc/profile
module load gcc-glibc/11

#
cd ${PBS_O_WORKDIR}
sort ${PBS_NODEFILE} | uniq -c | awk '{ printf("%s\n", $2); }' > mpd.nodes



#-------------------RUN THE EXECUTABLE---------------------------------#
mpiexec -machinefile mpd.nodes -n 16 ./my_mpi_application_long > ./output_long.txt 2>&1
#---------------------------------------------------------------------#
